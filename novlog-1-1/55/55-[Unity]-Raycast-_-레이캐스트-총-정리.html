
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title>[Unity] Raycast _ 레이캐스트 총 정리</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article">[Unity] Raycast _ 레이캐스트 총 정리</h2>
                                <div class="box-info">
                                    <p class="category">? Archive/GameDevelop</p>
                                    <p class="date">2021-06-18 13:46:06</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <p><figure class="imageblock alignLeft" data-origin-width="901" data-origin-height="901" data-filename="unitylogo.png" width="201" height="201" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img.png" data-origin-width="901" data-origin-height="901" data-filename="unitylogo.png" width="201" height="201" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><b>#0</b> Raycast?</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><b>#1</b> Raycast 사용법</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><b>#1.1</b> Debug.DrawRay() 레이저 출력</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><b>#1.2</b> RaycastHit 충돌 정보</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><b>#1.3</b> Physics.Raycast 레이케스트 사용</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><b>#1.4</b> 실행 결과</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><b>#2</b> LayerMask 특정 레이어만 인식</span></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000; background-color: #dddddd;">* 개인적인 유니티 공부 내용을 기록한 포스팅으로 잘못된 내용이 있을 수 있으며, 지속적으로 수정해 나갈 예정입니다.</span></p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5" />
<h2 data-ke-size="size26"><span style="font-family: 'Nanum Gothic'; color: #000000;"><span style="font-family: 'Noto Sans Demilight', 'Noto Sans KR';"><b>#0 Raycast?</b></span><br /></span></h2>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><span style="background-color: #333333; color: #ffffff;">Raycast</span>란, <span style="background-color: #dddddd;">A의 위치에서 B의 방향으로 레이저를 발사하여 해당하는 위치에 사물이 존재하는 지 판별하는 기능</span>입니다.</span></p>
<p data-ke-size="size16"><span style="color: #000000; font-family: 'Nanum Gothic';">Raycast는 Physics 클래스 안에 정의 되어 있으며 Raycast를 사용하기 위해선, <span style="background-color: #dddddd;">[1] 플레이어의 위치 / [2] 방향 / [3] RaycastHit (충돌 정보) / [4] 거리 정보</span>가 필요합니다. 간단한 예제를 통해 Raycast의 사용방법에 대해서 알아 보도록 하겠습니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="607" data-origin-height="277" width="480" height="219" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_1.png" data-origin-width="607" data-origin-height="277" width="480" height="219" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5" />
<h2 data-ke-size="size26"><span style="font-family: 'Noto Sans Demilight', 'Noto Sans KR';"><b><span style="color: #000000;">#1 Raycast 사용법</span></b></span></h2>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">우선 테스트를 위해서 <span style="background-color: #dddddd;">Player / Enemy 오브젝트</span>와 , <span style="background-color: #dddddd;">TestRay C#스크립트</span>를 하나씩 생성해 줍니다. 그 후에 <span style="background-color: #dddddd;">Player 오브젝트에 TestRay C# 스크립트를 부착</span>해 줍니다. 다음으로 차근차근 TestRay C# 스크립트를 작성해 보도록 하겠습니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="619" data-origin-height="368" width="484" height="288" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_2.png" data-origin-width="619" data-origin-height="368" width="484" height="288" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16">&nbsp;</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h2 data-ke-size="size26"><span style="font-family: 'Noto Sans Demilight', 'Noto Sans KR';"><b><span style="color: #000000;">#1.1 Debug.DrawRay() 레이저 출력</span></b></span></h2>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><span style="background-color: #333333; color: #ffffff;">Debug.DrawRay()</span> 는 <span style="background-color: #dddddd;">발사하는 레이저를 Scene 에서 볼 수 있도록 해주는 메서드</span>입니다. 반드시 필요한 것은 아니지만 테스트를 위해서 선언해 주도록 하겠습니다.</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">사용 방법은 <span style="background-color: #f6e199;">Debug.DrayRay( 플레이어 위치 , 방향 , 레이저 색 )</span> 으로, 최소 3가지 정보가 필요합니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="971" data-origin-height="276" width="782" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_3.png" data-origin-width="971" data-origin-height="276" width="782" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure><figure class="imageblock alignLeft" data-origin-width="604" data-origin-height="148" width="506" height="124" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_4.png" data-origin-width="604" data-origin-height="148" width="506" height="124" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16">&nbsp;</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h2 data-ke-size="size26"><span style="font-family: 'Noto Sans Demilight', 'Noto Sans KR';"><b><span style="color: #000000;">#1.2 RaycastHit 충돌 정보</span></b></span></h2>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">다음으로 <span style="background-color: #dddddd;">충돌할 정보를 저장할 변수</span>인 <span style="background-color: #333333; color: #ffffff;">RaycastHit</span> 이 필요합니다. (2D의 경우 RaycastHit2D로 선언합니다.)</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><span style="background-color: #dddddd;">hitInfo에는 충돌한 오브젝트의 정보가 저장</span>됩니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="967" data-origin-height="319" width="745" height="246" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_5.png" data-origin-width="967" data-origin-height="319" width="745" height="246" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h2 data-ke-size="size26"><span style="font-family: 'Noto Sans Demilight', 'Noto Sans KR';"><b><span style="color: #000000;">#1.3 Physics.Raycast 레이케스트 사용</span></b></span></h2>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">마지막으로 <span style="background-color: #333333; color: #ffffff;">Physics 클래스의 Raycast 멤버</span>를 사용해 레이저를 구현 할 차례입니다. 보통은 Raycast 를 사용하기는 하는데, Linecast 등 다른 형태의 레이저를 쏠 수도 있습니다.</span></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">사용방법은 <span style="background-color: #f6e199;">Physics.Raycast( [1]시작점 , [2]방향 , [3]충돌 정보, [4]거리 )</span> 로, [4]거리 를 생략할 경우 화면 끝까지 레이저가 무한대로 발사하게 됩니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="1017" data-origin-height="341" width="809" height="271" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_6.png" data-origin-width="1017" data-origin-height="341" width="809" height="271" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">저는 레이저가 특정 물체를 감지한다면 Debug.Log() 함수로 충돌정보(hitInfo)를 출력하도록 구현 했습니다.</span></p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h2 data-ke-size="size26"><span style="font-family: 'Noto Sans Demilight', 'Noto Sans KR';"><b><span style="color: #000000;">#1.4 실행 결과</span></b></span></h2>
<p data-ke-size="size16"><span style="color: #000000; font-family: 'Nanum Gothic';">아래와 같이 레이저가 Enemy 오브젝트와 충돌해서 충돌한 정보 (Enemy 이름) 를 콘솔창에 출력합니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="630" data-origin-height="293" width="505" height="235" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_7.png" data-origin-width="630" data-origin-height="293" width="505" height="235" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<pre id="code_1623991687529" class="cs" data-ke-language="cs" data-ke-type="codeblock"><code>using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Ray : MonoBehaviour
{
    void Update()
    {
        Debug.DrawRay(this.transform.position + Vector3.up, Vector3.forward * 10, Color.red);

        RaycastHit hitInfo;

        if (Physics.Raycast(this.transform.position, this.transform.forward, out hitInfo, 30.0f))
        {
            Debug.Log(hitInfo.transform.name);
        }
    }
}</code></pre>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5" />
<h2 data-ke-size="size26"><span style="font-family: 'Noto Sans Demilight', 'Noto Sans KR';"><b><span style="color: #000000;">#2 LayerMask 특정 레이어만 인식</span></b></span></h2>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;"><span style="background-color: #333333; color: #ffffff;">LayerMask</span>를 이용하면 <span style="background-color: #dddddd;">특정 물체만 인식 하도록 설정이 가능</span>합니다. 플레이어(Player)와 적(Enemy) 사이에 방해물 큐브 (Cube) 를 생성하고 실행해 보도록 하겠습니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="784" data-origin-height="462" width="594" height="350" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_8.png" data-origin-width="784" data-origin-height="462" width="594" height="350" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">위와 같이 큐브에 가로막혀서 플레이어가 적을 인식하지 못합니다. 여기서 <span style="background-color: #dddddd;">LayerMask를 이용하면 큐브를 무시하고 적만 인식 하도록 구현할 수 있습니다.</span></span></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">LayerMask 변수를 선언해 준 뒤, Physics.Rayscast의 5번째 인자로 선언한 layermask를 넣어 줍니다. layermask에는 감지 할 특정 레이어의 정보가 저장됩니다.</span></p>
<p><figure class="imageblock alignCenter" data-origin-width="1139" data-origin-height="413" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_9.png" data-origin-width="1139" data-origin-height="413" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">그리고, 플레이어 오브젝트를 클릭한 후 <span style="background-color: #dddddd;">Layer -&gt; Add Layer...</span> 로 Layer Inspector 창을 켠 뒤 <span style="background-color: #dddddd;">8,9,10 번 레이어에 Player, Cube , Enemy 레이어를 추가</span>해 줍니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="830" data-origin-height="538" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_10.png" data-origin-width="830" data-origin-height="538" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">만든 8,9,10번 <span style="background-color: #dddddd;">레이어를</span> 이름에 맞게 <span style="background-color: #dddddd;">오브젝트에 적용</span>해 준 뒤 <span style="background-color: #dddddd;">플레이어 오브젝트의 Test Ray 스크립트의 Layermask 항목에 감지할 레이어 (Enemy) 를 부착</span>해 줍니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="1186" data-origin-height="448" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_11.png" data-origin-width="1186" data-origin-height="448" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16"><span style="font-family: 'Nanum Gothic'; color: #000000;">이제 실행 해보면 큐브(Cube)를 무시하고 적(Enemy)의 정보를 콘솔에 출력합니다.</span></p>
<p><figure class="imageblock alignLeft" data-origin-width="788" data-origin-height="460" width="610" height="356" data-ke-mobilestyle="widthOrigin">
    <span data-lightbox="lightbox">
        <img src="./img/img_12.png" data-origin-width="788" data-origin-height="460" width="610" height="356" data-ke-mobilestyle="widthOrigin" />
    </span>
    <figcaption></figcaption>
</figure></p>
<pre id="code_1623991699678" class="cs" data-ke-language="cs" data-ke-type="codeblock"><code>using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Ray : MonoBehaviour
{
    [SerializeField] LayerMask layermask;

    void Update()
    {
        Debug.DrawRay(this.transform.position + Vector3.up, Vector3.forward * 10, Color.red);

        RaycastHit hitInfo;

        if (Physics.Raycast(this.transform.position, this.transform.forward, out hitInfo, 30.0f, layermask))
        {
            Debug.Log(hitInfo.transform.name);
        }
    }
}</code></pre>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5" />
                        </div>
                        <br/>
                        <div class="tags">
                            #유니티 #유니티3D #Raycast #유니티강의 #유니티2D #레이케스트 
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
